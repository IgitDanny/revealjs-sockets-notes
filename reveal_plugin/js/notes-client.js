"use strict";var UtilClientNotes=function(){var a=function(a,b){var c=new XMLHttpRequest;c.open("GET",a,!0),c.onreadystatechange=function(){var a=4,d=200;c.readyState===a&&c.status===d&&b(JSON.parse(c.responseText))},c.send()},b=function(){for(var a=document.getElementsByTagName("script"),b=0;b<a.length;b++){var c=a.item(b);if(c.src&&c.src.match(/notes-client\.js$/)){var d=c.src;return d.substring(0,d.indexOf("reveal_plugin"))}}return""};return{ajaxJSONGet:a,extractPath:b}}(),RevealClientNotes=function(){var a=null,b=null,c=null,d=null,e=null,f={},g=function(a){window.parent&&window.parent.document.body.getAttribute("sws-remote-iframe-desactiv")||(console.log("Initialize Client side"),b=a,h(),i(),n())},h=function(){b||(b={}),b.controlsColor||(b.controlsColor="white")},i=function(){UtilClientNotes.ajaxJSONGet(UtilClientNotes.extractPath()+"/reveal_plugin/conf/conf.json",function(b){a=b,l(),q()}),UtilClientNotes.ajaxJSONGet(UtilClientNotes.extractPath()+"/reveal_plugin/conf/ips.json",function(a){d=a}),document.onkeydown=j},j=function(a){var b=window.event?event:a;81===b.keyCode&&b.ctrlKey&&k()},k=function(){if(!document.querySelector("#sws-show-qr-code")){var b=document.createElement("DIV");b.setAttribute("id","sws-show-qr-code"),b.innerHTML='<div id="sws-show-qr-header"><h1 class="title">Choose, Generate and Scan !</h1><div class="close"> "Ctrl+Q" to hide</div><p>Choose the right network interface and click on \'Generate\' button</p><div id="listIp"></div></div><div id="sws-show-qr-bottom"><a id="qrCodeLink"><div id="qrCode"></div></a><h1>Scan with your phone</h1><div id="sws-show-qr-url"></div></div>',document.body.appendChild(b),e=new QRCode("qrCode",{text:"",width:256,height:256,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.H});for(var c="<select id='sws-show-qr-code-select'>",f=0;f<d.length;f++)c+="<option value='"+d[f].id+"' id='ip"+d[f].id+"' index='"+d[f].id+"' >"+d[f].name+"</option>";c+="</select>",c+="<button id='sws-show-qr-code-generate'>Generate</button>",document.querySelector("#listIp").innerHTML=c;var g=UtilClientNotes.extractPath();document.querySelector("#sws-show-qr-code-generate").addEventListener("click",function(){var b=document.getElementById("sws-show-qr-code-select"),c=b.options[b.selectedIndex].value,f="http://"+d[c].ip+":"+a.port+g.substr(g.indexOf(a.port)+(""+a.port).length,g.length)+(a.devMode?"remote/src/":"remote/")+"notes-speaker.html";e.clear(),e.makeCode(f),document.querySelector("#qrCodeLink").setAttribute("href",f),document.querySelector("#sws-show-qr-url").innerHTML='<span style="text-transform:uppercase; font-weight:bold;">Or goto : </span><br>'+f})}var h=document.querySelector("#sws-show-qr-code");h.style.display="none"===h.style.display?"":"none"},l=function(){for(var d=0,e=!0;e;)d++,e=Reveal.getSlide(d);c=io.connect("http://"+window.location.hostname+":"+a.port),c.on("connect",function(){c.emit("message",{type:"config",url:window.location.pathname,controlsColor:b.controlsColor,nbSlides:d-1}),c.emit("message",{type:"config",indices:Reveal.getIndices()})}),c.on("message",function(a){if("operation"===a.type&&"show"===a.data)Reveal.slide(a.index.h,a.index.v,a.index.f?a.index.f:0);else if("ping"===a.type)document.querySelector("#sws-show-qr-code")&&(document.querySelector("#sws-show-qr-code").style.display="none"),c.emit("message",{type:"config",url:window.location.pathname,controlsColor:b.controlsColor,nbSlides:d-1}),c.emit("message",{type:"config",indices:Reveal.getIndices()});else if("ping-plugin"===a.type)for(var e=Object.keys(f),g=0;g<e.length;g++)c.emit("message",{type:"plugin",action:"activate",id:e[g]});else"communicate-plugin"===a.type&&a.id&&f[a.id]&&f[a.id](a.data)})},m=function(){var a=Reveal.getCurrentSlide(),b=null,d=a.querySelector("aside.notes");b={notes:d?d.innerHTML:"",markdown:d?"string"==typeof d.getAttribute("data-markdown"):!1},c&&void 0!==b.notes&&c.emit("message",{type:"notes",data:b}),c&&c.emit("message",{type:"config",indices:Reveal.getIndices()})},n=function(){Reveal.addEventListener("slidechanged",m)},o=function(a){var b=document.createElement("script");b.type="text/javascript",b.src=a,b.async=!0,document.getElementsByTagName("head")[0].appendChild(b)},p=function(a){var b=document.createElement("link");b.rel="stylesheet",b.type="text/css",b.href=a,b.media="all",b.async=!0,document.getElementsByTagName("head")[0].appendChild(b)},q=function(){var b=UtilClientNotes.extractPath()+"reveal_plugin/"+(a.devMode?"src/":"");o(b+"components/qrcode/qrcode.min.js"),p(b+"css/main.css")},r=function(a,b){f[a]=b};return{registerPlugin:r,init:g}}();